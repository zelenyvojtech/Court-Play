{% extends "base.html" %}

{% block title %}Detail rezervace #{{ reservation.reservation_id }} – Court &amp; Play{% endblock %}

{% block content %}
<section class="section">
  <h1 class="section__title">
    Rezervace #{{ reservation.reservation_id }}
  </h1>
  <p class="section__subtitle">
    Detail rezervace a změna stavu (pouze MANAGER/ADMIN).
  </p>

  <div class="card" style="margin-bottom:1.5rem;">
    <p><strong>Uživatel:</strong> #{{ reservation.user_id }}</p>
    <p><strong>Kurt:</strong> Kurt #{{ reservation.courts_id }}</p>
    <p>
      <strong>Datum a čas:</strong>
      {{ reservation.start.strftime("%d.%m.%Y") }},
      {{ reservation.start.strftime("%H:%M") }}–{{ reservation.end.strftime("%H:%M") }}
    </p>
    <p><strong>Tarif (ID):</strong> #{{ reservation.price_list_id }}</p>
    <p>
      <strong>Cena celkem:</strong>
      {% if reservation.price_total is not none %}
        {{ "%.0f"|format(reservation.price_total) }} Kč
      {% else %}
        –
      {% endif %}
    </p>
    <p>
      <strong>Stav:</strong>
      {{ reservation.state }}
    </p>
    <p>
      <strong>Vytvořeno:</strong>
      {{ reservation.created_at.strftime("%d.%m.%Y %H:%M") }}
    </p>
  </div>

  <h2 class="section__title" style="font-size:1.1rem;">Změna stavu</h2>
  <form method="post" action="/reservations/{{ reservation.reservation_id }}/state" class="form" style="max-width:320px;">
    <div class="form__field">
      <label class="form__label" for="state">Nový stav</label>
      <select id="state" name="state" class="form__select">
        <option value="PENDING"   {% if reservation.state == "PENDING" %}selected{% endif %}>Čeká na potvrzení</option>
        <option value="CONFIRMED" {% if reservation.state == "CONFIRMED" %}selected{% endif %}>Potvrzeno</option>
        <option value="CANCELLED" {% if reservation.state == "CANCELLED" %}selected{% endif %}>Zrušeno</option>
        <option value="FINISHED"  {% if reservation.state == "FINISHED" %}selected{% endif %}>Odehráno</option>
      </select>
    </div>

    <div class="form__actions">
      <button type="submit" class="btn btn--primary">
        Uložit stav
      </button>
      <a href="/reservations" class="btn btn--ghost">
        Zpět na přehled
      </a>
    </div>
  </form>
</section>
{% endblock %}
